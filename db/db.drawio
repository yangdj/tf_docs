<mxfile host="b8b90eaf-4cbe-415e-864b-340e42f2c68f" modified="2021-07-22T10:51:01.871Z" agent="5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Code/1.47.3 Chrome/78.0.3904.130 Electron/7.3.2 Safari/537.36" etag="P4AbUP8hIaGefnMgd01P" version="13.1.3" pages="3">
    <diagram id="bLB-15KIItHZLIwzvUtw" name="install">
        <mxGraphModel dx="822" dy="480" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
            <root>
                <mxCell id="r4bx7zmuQvU5lQe_M6j6-0"/>
                <mxCell id="r4bx7zmuQvU5lQe_M6j6-1" parent="r4bx7zmuQvU5lQe_M6j6-0"/>
                <mxCell id="QrZE1w03IrAIoicb0JWs-0" value="&lt;table cellpadding=&quot;4&quot; cellspacing=&quot;0&quot; border=&quot;1&quot; style=&quot;font-size: 1em ; width: 100% ; height: 100%&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th&gt;db&lt;/th&gt;&lt;th&gt;install&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;mariadb&lt;/td&gt;&lt;td&gt;&lt;h3&gt;dependencies&lt;/h3&gt;&lt;h4&gt;1. &lt;font face=&quot;Courier New&quot;&gt;MariaDB.repo&lt;/font&gt;&lt;/h4&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;# MariaDB 10.3 CentOS repository list&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;# http://downloads.mariadb.org/mariadb/repositories/&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;[mariadb] name = MariaDB&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;baseurl = http://yum.mariadb.org/10.3/centos7-amd64&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;gpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDB&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;gpgcheck=1&lt;/font&gt;&lt;/div&gt;&lt;h4&gt;2. install repo&lt;/h4&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;cp MariaDB.repo /etc/yum.repos.d/&lt;/font&gt;&lt;/div&gt;&lt;h3&gt;install&lt;/h3&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;sudo yum install MariaDB-server MariaDB-client&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;rabbitmq&lt;/td&gt;&lt;td&gt;&lt;h4&gt;dependencies&lt;/h4&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;wget https://packages.erlang-solutions.com/erlang-solutions-1.0-1.noarch.rpm&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;sudo rpm -Uvh erlang-solutions-1.0-1.noarch.rpm&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;sudo yum install erlang socat&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34; ; font-size: 1em&quot;&gt;erlang&lt;/span&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34; ; font-size: 1em&quot;&gt;socat&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h3&gt;install&lt;/h3&gt;&lt;/div&gt;&lt;h4&gt;1. source from rpm&lt;/h4&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;wget https://dl.bintray.com/rabbitmq/all/rabbitmq-server/3.7.4/rabbitmq-server-3.7.4-1.el7.noarch.rpm&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;sudo rpm -ivh rabbitmq-server-3.7.4-1.el7.noarch.rpm&lt;/font&gt;&lt;/div&gt;&lt;h4&gt;2. systemd&lt;/h4&gt;&lt;div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;sudo systemctl enable rabbitmq-server&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;sudo systemctl start rabbitmq-server&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;h3&gt;command&lt;/h3&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;sudo rabbitmq-plugins enable rabbitmq_management&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;sudo rabbitmqctl add_user myroot myroot_password&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;sudo rabbitmqctl add_vhost myvhost&lt;/span&gt;&lt;font face=&quot;Courier New&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;sudo rabbitmqctl set_user_tags myroot administrator&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;sudo rabbitmqctl set_permissions -p myvhost myairflow &quot;.*&quot; &quot;.*&quot; &quot;.*&quot;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; " style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1" parent="r4bx7zmuQvU5lQe_M6j6-1" vertex="1">
                    <mxGeometry x="10" y="10" width="810" height="830" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
    <diagram id="qs0QUAytXHS2nKGxKQSG" name="mariadb-config">
        <mxGraphModel dx="822" dy="480" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
            <root>
                <mxCell id="29MXGs88AO1VGB2FE-rs-0"/>
                <mxCell id="29MXGs88AO1VGB2FE-rs-1" parent="29MXGs88AO1VGB2FE-rs-0"/>
                <mxCell id="451GmTiY2wvtwt0KklQe-0" value="&lt;table cellpadding=&quot;4&quot; cellspacing=&quot;0&quot; border=&quot;1&quot; style=&quot;font-size: 1em ; width: 100% ; height: 100%&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th&gt;config&lt;/th&gt;&lt;th&gt;contents&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;basic&lt;/td&gt;&lt;td&gt;&lt;h3&gt;initial mariadb&lt;/h3&gt;&lt;h4&gt;1. start server&lt;/h4&gt;&lt;div&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34; ; font-size: 1em&quot;&gt;sudo systemctl start mariadb.service&lt;/span&gt;&lt;br&gt;&lt;h4&gt;2. secure config&lt;/h4&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34; ; font-size: 1em&quot;&gt;mysql_secure_installation&lt;/span&gt;&lt;/div&gt;&lt;h4&gt;&lt;span style=&quot;font-size: 1em&quot;&gt;3. change datapath and port optionally&lt;/span&gt;&lt;/h4&gt;&lt;div&gt;&lt;span style=&quot;font-size: 1em&quot;&gt;&lt;font face=&quot;Courier New&quot;&gt;MARIADB_DATA_HOME=/mariadb/home&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;mysql -u root -p -e &quot;select @@datadir, @@port&quot;&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;sudo chown -R mysql: ${MARIADB_DATA_HOME}&lt;/font&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;sudo cp -R -p /var/lib/mysql/* ${MARIADB_DATA_HOME}&lt;br&gt;&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;div&gt;may need selinux settings for centos:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;sudo semanage fcontext -a -t mysqld_db_t &quot;${&lt;/font&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;MARIADB_DATA_HOME&lt;/span&gt;&lt;font face=&quot;Courier New&quot;&gt;}(/.*)?&quot;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;sudo restorecon -R ${&lt;/font&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;MARIADB_DATA_HOME&lt;/span&gt;&lt;font face=&quot;Courier New&quot;&gt;}&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;h4&gt;&lt;span style=&quot;font-size: 1em&quot;&gt;4. change port optionally&lt;/span&gt;&lt;/h4&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;MARIADB_PORT=3308(3306 default)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;&lt;span style=&quot;font-size: 1em&quot;&gt;config file&amp;nbsp;&lt;/span&gt;&lt;font face=&quot;Courier New&quot; style=&quot;font-size: 1em&quot;&gt;/etc/my.cnf.d/server.cnf&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;div&gt;may need additional settings:&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;sudo yum install policycoreutils-python&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;sudo semanage port -a -t mysqld_port_t -p tcp ${MARIADB_PORT}&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;h3&gt;config files&lt;/h3&gt;&lt;/div&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;&lt;font face=&quot;courier new&quot;&gt;/etc/my.cnf&lt;/font&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;courier new&quot;&gt;/etc/my.cnf.d/server.cnf&lt;br&gt;&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;courier new&quot;&gt;~/.my.cnf&lt;br&gt;&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;/etc/my.cnf&lt;/td&gt;&lt;td&gt;&lt;font face=&quot;Courier New&quot;&gt;[client-server]&lt;br&gt;&lt;br&gt;[mysqld]&lt;br&gt;datadir=${MARIADB_DATA_HOME}&lt;br&gt;socket=&lt;/font&gt;${&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;MARIADB_DATA_HOME}&lt;/span&gt;&lt;font face=&quot;Courier New&quot;&gt;/mysql.sock&lt;br&gt;&lt;br&gt;[client]&lt;br&gt;socket=&lt;/font&gt;${&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;MARIADB_DATA_HOME}&lt;/span&gt;&lt;font face=&quot;Courier New&quot;&gt;/mysql.sock&lt;br&gt;&lt;br&gt;!includedir /etc/my.cnf.d&lt;/font&gt;&lt;br&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;/etc/my.cnf.d/server.cnf&lt;br&gt;&lt;/td&gt;&lt;td&gt;&lt;font face=&quot;Courier New&quot;&gt;[mysqld]&lt;br&gt;port=3308&lt;/font&gt;&lt;br&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;~/.my.cnf&lt;br&gt;&lt;/td&gt;&lt;td&gt;&lt;font face=&quot;Courier New&quot;&gt;[clienthost1] # or [client]&lt;/font&gt;&lt;br style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;host=localhost&lt;br&gt;&lt;/span&gt;&lt;font face=&quot;Courier New&quot;&gt;port=port&lt;br&gt;socket=/tmp/mysql.sock&lt;br&gt;&lt;/font&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;database=dbname&lt;/span&gt;&lt;font face=&quot;Courier New&quot;&gt;&lt;br&gt;user=username&lt;br&gt;password=passwd&lt;br&gt;&lt;br&gt;[clienthost2]&lt;br&gt;...&lt;br&gt;&lt;br&gt;# connect to mysql&lt;br&gt;#&amp;nbsp;mysql --defaults-group-suffix=host1&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; " style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1" parent="29MXGs88AO1VGB2FE-rs-1" vertex="1">
                    <mxGeometry x="19" y="15" width="771" height="1045" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
    <diagram id="DSATgfqD7Z32CIduniQ1" name="mariadb-cmd">
        <mxGraphModel dx="641" dy="480" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
            <root>
                <mxCell id="ZN6FDCZ_Gpi1RWRekCws-0"/>
                <mxCell id="ZN6FDCZ_Gpi1RWRekCws-1" parent="ZN6FDCZ_Gpi1RWRekCws-0"/>
                <mxCell id="ZN6FDCZ_Gpi1RWRekCws-2" value="&lt;table cellpadding=&quot;4&quot; cellspacing=&quot;0&quot; border=&quot;1&quot; style=&quot;font-size: 1em ; width: 100% ; height: 100%&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th&gt;command&lt;/th&gt;&lt;th&gt;contents&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;database&lt;/td&gt;&lt;td&gt;&lt;font face=&quot;Courier New&quot;&gt;create database flow default character set utf8 default collate utf8_bin&lt;br&gt;&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;user&lt;/td&gt;&lt;td&gt;&lt;font face=&quot;Courier New&quot;&gt;create user flow identified by 'flow'&lt;/font&gt;;&lt;br&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;span style=&quot;font-size: 1em&quot;&gt;privilege&lt;/span&gt;&lt;br&gt;&lt;/td&gt;&lt;td&gt;&lt;ol&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;grant all privileges on flow.* to 'flow'@'%'&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;flush privileges&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;show grants for 'flow'&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; " style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1" parent="ZN6FDCZ_Gpi1RWRekCws-1" vertex="1">
                    <mxGeometry x="10" y="10" width="640" height="160" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>
