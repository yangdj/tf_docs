<mxfile host="" modified="2020-08-03T09:24:39.689Z" agent="5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Code/1.46.1 Chrome/78.0.3904.130 Electron/7.3.1 Safari/537.36" etag="kI7kujX7iDsdVQRonOJo" version="13.1.3" pages="4">
    <diagram id="6hGFLwfOUW9BJ-s0fimq" name="spark">
        <mxGraphModel dx="571" dy="480" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="2" value="" style="swimlane;html=1;startSize=20;horizontal=1;containerType=tree;fillColor=none;strokeColor=none;" parent="1" vertex="1">
                    <mxGeometry x="8" y="13" width="516" height="310" as="geometry"/>
                </mxCell>
                <mxCell id="3" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;" parent="2" source="7" target="8" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="7" value="spark" style="ellipse;whiteSpace=wrap;html=1;align=center;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};" parent="2" vertex="1">
                    <mxGeometry x="6" y="69" width="100" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="8" value="source" style="whiteSpace=wrap;html=1;rounded=1;arcSize=50;align=center;verticalAlign=middle;strokeWidth=1;autosize=1;spacing=4;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};" parent="2" vertex="1">
                    <mxGeometry x="126" y="6" width="71" height="26" as="geometry"/>
                </mxCell>
                <mxCell id="12" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;" parent="2" source="7" target="13" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="114" y="102" as="sourcePoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="13" value="sink" style="whiteSpace=wrap;html=1;rounded=1;arcSize=50;align=center;verticalAlign=middle;strokeWidth=1;autosize=1;spacing=4;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};" parent="2" vertex="1">
                    <mxGeometry x="126" y="147" width="56" height="26" as="geometry"/>
                </mxCell>
                <mxCell id="14" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;" parent="2" source="7" target="15" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="114" y="102" as="sourcePoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="15" value="process" style="whiteSpace=wrap;html=1;rounded=1;arcSize=50;align=center;verticalAlign=middle;strokeWidth=1;autosize=1;spacing=4;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};" parent="2" vertex="1">
                    <mxGeometry x="123" y="76" width="77" height="26" as="geometry"/>
                </mxCell>
                <mxCell id="16" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;" parent="2" source="15" target="17" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="114" y="102" as="sourcePoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="17" value="transform" style="whiteSpace=wrap;html=1;rounded=1;arcSize=50;align=center;verticalAlign=middle;strokeWidth=1;autosize=1;spacing=4;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};" parent="2" vertex="1">
                    <mxGeometry x="220" y="40" width="86" height="26" as="geometry"/>
                </mxCell>
                <mxCell id="18" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;" parent="2" source="15" target="19" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="208" y="102" as="sourcePoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="19" value="action" style="whiteSpace=wrap;html=1;rounded=1;arcSize=50;align=center;verticalAlign=middle;strokeWidth=1;autosize=1;spacing=4;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};" parent="2" vertex="1">
                    <mxGeometry x="220" y="111" width="91" height="26" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
    <diagram id="vWr77l8NIJXA0AVOj1JU" name="process">
        <mxGraphModel dx="1274" dy="480" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
            <root>
                <mxCell id="Fq4y0ZjopHzJ_FTKpw_i-0"/>
                <mxCell id="Fq4y0ZjopHzJ_FTKpw_i-1" parent="Fq4y0ZjopHzJ_FTKpw_i-0"/>
                <mxCell id="Fq4y0ZjopHzJ_FTKpw_i-2" value="&lt;table cellpadding=&quot;4&quot; cellspacing=&quot;0&quot; border=&quot;1&quot; style=&quot;font-size: 1em ; width: 100% ; height: 100%&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th&gt;Object&lt;/th&gt;&lt;td&gt;Content&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;[org.apache.spark.sql]&lt;br&gt;&lt;br&gt;SparkSession&lt;/td&gt;&lt;td&gt;&lt;h3&gt;Initialization&lt;/h3&gt;&lt;div&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;import org.apache.spark.sql.SparkSession&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34; ; font-size: 1em&quot;&gt;val spark = SparkSession&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;&amp;nbsp; &amp;nbsp; .builder&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34; ; font-size: 1em&quot;&gt;&amp;nbsp; &amp;nbsp; .appName(&quot;spark example&quot;)&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;courier new&quot;&gt;&amp;nbsp; &amp;nbsp; .config(&quot;spark.config.opiton&quot;, &quot;config-value&quot;)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;&amp;nbsp; &amp;nbsp; .getOrCreate()&lt;/span&gt;&lt;/div&gt;&lt;h3&gt;Stop&lt;/h3&gt;&lt;div&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;spark.stop()&lt;/span&gt;&lt;/div&gt;&lt;h3&gt;Configuration&lt;/h3&gt;&lt;div&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;spark.conf.get(&quot;spark.config.option&quot;)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;spark.conf.set(&quot;spark.config.option&quot;, &quot;other-config-value&quot;)&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;[org.apache.spark.sql]&lt;br&gt;&lt;br&gt;Row&lt;br&gt;&lt;/td&gt;&lt;td&gt;&lt;h3&gt;Description&lt;/h3&gt;&lt;ol&gt;&lt;li&gt;a generic&amp;nbsp;&lt;b&gt;untyped&lt;/b&gt;&amp;nbsp;JVM object&lt;/li&gt;&lt;/ol&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;[org.apache.spark.sql.types]&lt;br&gt;&lt;br&gt;1. StructField&lt;br&gt;2. StructType&lt;br&gt;&lt;/td&gt;&lt;td&gt;&lt;h3&gt;usage&lt;/h3&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;val field = StructField(fieldName, StringType, nullable = true]&lt;/span&gt;&lt;br style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;val schema = StructType(field1, field2, ...)&lt;/span&gt;&lt;br&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;io source&lt;/td&gt;&lt;td&gt;&lt;h3&gt;Prepare&lt;/h3&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;case class Person(name: String, age: Long)&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;val peopleRDD = spark.sparkContext.textFile(&quot;people.txt&quot;)&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;&lt;font style=&quot;font-size: 1em&quot;&gt;val rowRDD = peopleRDD.map(_.split(&quot;, &quot;))&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;&lt;span style=&quot;font-size: 1em&quot;&gt;&amp;nbsp; &amp;nbsp; .map(attrs =&amp;gt; Row(attrs(0), attrs(1).trim.toInt))&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 1em&quot;&gt;&lt;font face=&quot;Courier New&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 1em&quot;&gt;&lt;font face=&quot;Courier New&quot;&gt;val schemaString = &quot;name age&quot;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;val fields = schemaString.split(&quot; &quot;)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; .map(fieldName =&amp;gt; StructField(fieldName, StringType, nullable = true))&lt;br&gt;val schema = StructType(fields)&lt;/font&gt;&lt;span style=&quot;font-size: 1em ; font-family: &amp;#34;courier new&amp;#34;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;h3&gt;RDD&lt;/h3&gt;&lt;h4&gt;1. from files&lt;/h4&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;sparkContext&lt;/font&gt; is used to create &lt;font face=&quot;Courier New&quot;&gt;RDD&lt;/font&gt;&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;val peopleRDD = spark.sparkContext.textFile(&quot;people.txt&quot;)&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h4&gt;2. from DataSet and DataFrame&lt;/h4&gt;&lt;ol&gt;&lt;li&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;val peopleRDD =&amp;nbsp;peopleDS.rdd&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;val peopleRDD =&amp;nbsp;peopleDF.rdd&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;div&gt;&lt;h3&gt;Dataset&lt;/h3&gt;&lt;/div&gt;&lt;h4&gt;1. from spark&lt;/h4&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;spark.range(100)&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h4&gt;2. from scala&lt;/h4&gt;&lt;ol&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;val peopleDS = Seq(Person(&quot;Andy&quot;, 32)).toDS()&lt;br&gt;&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;val peopleDS = spark.createDateset(List(Person(&quot;Andy&quot;, 32), Person(&quot;Bob&quot;, 12)))&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h4&gt;3. from RDD and DataFrame&lt;/h4&gt;&lt;ol&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;val peopleDS =&amp;nbsp;peopleRDD.toDS()&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;val peopleDS = peopleDF.as[Person]&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;div&gt;&lt;div&gt;&lt;h3&gt;DataFrame&lt;/h3&gt;&lt;/div&gt;&lt;h4&gt;1. from scala&lt;/h4&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;List((&quot;Andy&quot;, 32)).toDF(&quot;name&quot;, &quot;age&quot;)&lt;br&gt;&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;spark.createDateset(List(Person(&quot;Andy&quot;, 32), Person(&quot;Bob&quot;, 12)))&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;h4&gt;2. from RDD&lt;/h4&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;val peopelDF =&amp;nbsp;peopleRDD.toDF&lt;br&gt;&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;val peopelDF = spark.createDataFrame(rowRDD, schema)&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h4&gt;3. from files&lt;/h4&gt;&lt;ol&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;val peopleDF = spark.read.textFile(&quot;people.txt&quot;)&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;val peopleDF =&amp;nbsp;spark.read.json(&quot;people.json&quot;)&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;val userDF = spark.read.load(&quot;users.parquet&quot;) - &lt;/font&gt;parquet default&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;val userDF = spark.read.format(&quot;json&quot;).load(&quot;users.json&quot;)&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;val userDF = spark.sql(&quot;select * from parquet.users.parquet&quot;)&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;io sink&lt;/td&gt;&lt;td&gt;&lt;h3&gt;DataFrame&lt;/h3&gt;&lt;h4&gt;1. to files&lt;/h4&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;userDF.write.save(&quot;users.parquet&quot;) -&amp;nbsp;&lt;/font&gt;parquet default&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;spark.write.format(&quot;json&quot;).save(&quot;users.json&quot;)&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;[org.apache.spark.rdd]&lt;br&gt;&lt;br&gt;RDD&lt;/td&gt;&lt;td&gt;&lt;h3&gt;Description&lt;/h3&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;an immutable distributed collection partitioned across nodes&lt;/li&gt;&lt;li&gt;&lt;b&gt;strong-typed&lt;/b&gt; and operate in parallel with low-level API&amp;nbsp;&lt;i style=&quot;font-size: 1em&quot;&gt;transformations&lt;/i&gt;&lt;span style=&quot;font-size: 1em&quot;&gt;&amp;nbsp;and&amp;nbsp;&lt;/span&gt;&lt;i style=&quot;font-size: 1em&quot;&gt;actions&lt;/i&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;h3&gt;Transforms&lt;/h3&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.map(); df.map(d =&amp;gt; d.getAs[Long](&quot;age&quot;))&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.flatMap()&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.filter()&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.groupByKey().count()&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h3&gt;Actions&lt;/h3&gt;&lt;/div&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34; ; font-size: 1em&quot;&gt;.count()&lt;/span&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.first()&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.take(10)&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.collect()&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.reduce()&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h3&gt;Cache&lt;/h3&gt;&lt;/div&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.cache()&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.persist()&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;[org.apache.spark.sql]&lt;br&gt;&lt;br&gt;Dateset&lt;/td&gt;&lt;td&gt;&lt;h3&gt;Description&lt;/h3&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;a collection of&amp;nbsp; compile-time safety and&amp;nbsp;&lt;b&gt;strong-typed&lt;/b&gt;&amp;nbsp;JVM objects dictated by a case class&lt;/li&gt;&lt;li&gt;APIs are all expressed as lambda functions.&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;Dataset[T]&amp;nbsp;&lt;/font&gt;typed API is optimized for data engineering tasks&lt;/li&gt;&lt;/ol&gt;&lt;h3&gt;Methods&lt;/h3&gt;&lt;/div&gt;&lt;h4&gt;metadata&lt;/h4&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.columns&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.schema&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.printSchema&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.show&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.explain([true, false]) - default false&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h4&gt;type-safe&lt;/h4&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.map(d =&amp;gt; (d.name, d.age == 10))&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.flatMap()&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.filter(d =&amp;gt; d.age === 10)&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;h4&gt;Untyped (aka DataFrame operations)&lt;/h4&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;span style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;// implicitly convert RDDs to DataFrames or use $-notation&lt;/span&gt;&lt;font face=&quot;Courier New&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Courier New&quot;&gt;import spark.implicits._&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;ol&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.select(&quot;name&quot;, &quot;age&quot;); .select($&quot;name&quot;, $&quot;age&quot; + 1, $&quot;age&quot; &amp;gt; 20)&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.filter($&quot;age&quot; === 10)&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.groupBy(&quot;age&quot;, &quot;name&quot;).count()&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;font face=&quot;Courier New&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;[org.apache.spark.sql]&lt;br&gt;&lt;br&gt;DataFrame&lt;/td&gt;&lt;td&gt;&lt;div&gt;&lt;h3&gt;Description&lt;/h3&gt;&lt;/div&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;an&amp;nbsp;&lt;i&gt;alias&lt;/i&gt;&amp;nbsp;for a collection of generic objects of&amp;nbsp;&lt;font face=&quot;Courier New&quot;&gt;Dataset[Row]&lt;/font&gt; and organized into named columns&lt;/li&gt;&lt;li&gt;faster and suitable for interactive analysis&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;SQL&lt;/td&gt;&lt;td&gt;&lt;h3&gt;Methods&lt;/h3&gt;&lt;ol&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;df.createOrReplaceTempView(&quot;people&quot;)&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;df.createGlobalTempView(&quot;people&quot;)&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;spark.sql(&quot;select * from people&quot;)&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;spark.sql(&quot;select * from global_temp.people&quot;)&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;spark.newSession().sql(&quot;select * from global_temp.people&quot;)&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; " style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;fillColor=none;glass=0;shadow=0;comic=0;" parent="Fq4y0ZjopHzJ_FTKpw_i-1" vertex="1">
                    <mxGeometry x="13" y="11" width="806" height="2685" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
    <diagram id="vYgjneMSaIXmTNUW5MwD" name="source-file">
        <mxGraphModel dx="1274" dy="480" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
            <root>
                <mxCell id="UfpXyJ3gTMX34qGy4Cl5-0"/>
                <mxCell id="UfpXyJ3gTMX34qGy4Cl5-1" parent="UfpXyJ3gTMX34qGy4Cl5-0"/>
                <mxCell id="UfpXyJ3gTMX34qGy4Cl5-2" value="&lt;table cellpadding=&quot;4&quot; cellspacing=&quot;0&quot; border=&quot;1&quot; style=&quot;font-size: 1em ; width: 100% ; height: 100%&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th&gt;format&lt;/th&gt;&lt;th&gt;load settings&lt;/th&gt;&lt;td&gt;write settings&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;text&lt;/td&gt;&lt;td&gt;&lt;br&gt;&lt;/td&gt;&lt;td&gt;&lt;br&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;csv&lt;/td&gt;&lt;td&gt;&lt;ol&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;option(&quot;sep&quot;, &quot;,&quot;)&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;option(&quot;inferSchema, &quot;true&quot;)&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;option(&quot;header&quot;, &quot;true&quot;)&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;option(&quot;pathGlobalFilter&quot;, &quot;*.parquet&quot;)&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/td&gt;&lt;td&gt;&lt;br&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;json&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;br&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;parquet&lt;/td&gt;&lt;td&gt;&lt;br&gt;&lt;/td&gt;&lt;td&gt;&lt;ol&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;.write.partitionBy(&quot;name&quot;)&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;orc&lt;/td&gt;&lt;td&gt;&lt;br&gt;&lt;/td&gt;&lt;td&gt;&lt;ol&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;option(&quot;orc.bloom.filter.columns&quot;, &quot;favorite_color&quot;)&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;option(&quot;orc.dictionary.key.threshold&quot;, &quot;1.0&quot;)&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;option(&quot;orc.column.encoding.direct&quot;, &quot;name&quot;)&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;jdbc&lt;/td&gt;&lt;td&gt;&lt;br&gt;&lt;/td&gt;&lt;td&gt;&lt;br&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; " style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1" parent="UfpXyJ3gTMX34qGy4Cl5-1" vertex="1">
                    <mxGeometry x="10" y="370" width="800" height="380" as="geometry"/>
                </mxCell>
                <mxCell id="rSd9CJvAgJ8ev4Khk3t0-0" value="&lt;table cellpadding=&quot;4&quot; cellspacing=&quot;0&quot; border=&quot;1&quot; style=&quot;font-size: 1em ; width: 100% ; height: 100%&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th&gt;file operations&lt;/th&gt;&lt;td&gt;&lt;b&gt;storage&lt;/b&gt;&lt;/td&gt;&lt;th&gt;format&lt;/th&gt;&lt;td&gt;&lt;b&gt;mode&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;font face=&quot;Courier New&quot;&gt;spark.read&lt;br&gt;&amp;nbsp; &amp;nbsp; .format(&quot;csv&quot;)&lt;br&gt;&amp;nbsp; &amp;nbsp; .option(&quot;header&quot;, &quot;true&quot;)&lt;br&gt;&amp;nbsp; &amp;nbsp; .load(&quot;users.csv&quot;)&lt;br&gt;&lt;br&gt;usersDF.write&lt;br&gt;&amp;nbsp; &amp;nbsp; .format(&quot;csv&quot;)&lt;br&gt;&amp;nbsp; &amp;nbsp; .option(&quot;header&quot;, &quot;true&quot;)&lt;br&gt;&amp;nbsp; &amp;nbsp; .mode(modeValue)&lt;br&gt;&amp;nbsp; &amp;nbsp; .save(&quot;users.csv&quot;)&lt;br&gt;&lt;br&gt;usersDF.write&lt;br&gt;&amp;nbsp; &amp;nbsp; .partitionBy(&quot;color&quot;)&lt;br&gt;&amp;nbsp; &amp;nbsp; .bucketBy(10, &quot;name&quot;)&lt;br&gt;&amp;nbsp; &amp;nbsp; .sortBy(&quot;age&quot;)&lt;br&gt;&amp;nbsp; &amp;nbsp; .saveAsTable(&quot;t_par_but&quot;)&lt;/font&gt;&lt;/td&gt;&lt;td&gt;&lt;ol&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;file:///home/...&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;hdfs://..&lt;/font&gt;.&lt;/li&gt;&lt;/ol&gt;&lt;/td&gt;&lt;td&gt;&lt;ol&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;text&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;csv&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;json&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;parquet&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;orc&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;jdbc&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font face=&quot;Courier New&quot;&gt;libsvm&lt;/font&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/td&gt;&lt;td&gt;&lt;font face=&quot;Courier New&quot;&gt;import org.apache.spark.sql.SaveMode&lt;/font&gt;&lt;br&gt;&lt;ol&gt;&lt;li style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;SaveMode.ErrorIfExists (default)&lt;/li&gt;&lt;li style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;SaveMode.Append&lt;/li&gt;&lt;li style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;SaveMode.Overwrite&lt;/li&gt;&lt;li style=&quot;font-family: &amp;#34;courier new&amp;#34;&quot;&gt;&lt;font face=&quot;Courier New&quot; style=&quot;font-size: 1em&quot;&gt;SaveMode.Ignore - &lt;/font&gt;&lt;span style=&quot;font-size: 1em ; font-family: &amp;#34;helvetica&amp;#34;&quot;&gt;do nothing when exists&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; " style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1" parent="UfpXyJ3gTMX34qGy4Cl5-1" vertex="1">
                    <mxGeometry x="10" y="10" width="810" height="280" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
    <diagram id="ho86VfKQqOMVy6nYTFh-" name="snippets">
        <mxGraphModel dx="1274" dy="480" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
            <root>
                <mxCell id="hV-wvRThAPQCknKOUPM6-0"/>
                <mxCell id="hV-wvRThAPQCknKOUPM6-1" parent="hV-wvRThAPQCknKOUPM6-0"/>
                <mxCell id="hV-wvRThAPQCknKOUPM6-2" value="&lt;br&gt;import org.apache.spark.sql.SparkSession&lt;br&gt;&lt;br&gt;object SimpleApp {&lt;br&gt;&amp;nbsp; &amp;nbsp; def main(args: Array[String]) {&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; val spark = SparkSession.builder.appName(&quot;Simple Application&quot;).getOrCreate()&lt;br&gt;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; // this import is needed to use the $-notation&lt;br&gt;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; spark.read.textFile(logFile)&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ...&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; spark.stop()&lt;br&gt;&amp;nbsp; &amp;nbsp; }&lt;br&gt;}" style="rounded=1;whiteSpace=wrap;html=1;align=left;fontFamily=Courier New;arcSize=3;spacingLeft=0;" parent="hV-wvRThAPQCknKOUPM6-1" vertex="1">
                    <mxGeometry x="10" y="19" width="806" height="230" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>